<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <title>E-Commerce</title>
</head>
<body>
    <header>
    <div class="logo"><span style="color:#f0c14b;">E-Commerce</span> <span style="color:#232f3e;"></span></div>
    <!-- Add this after your logo div in the header -->
    <button id="dark-mode-toggle" title="Toggle dark mode" style="background:none;border:none;cursor:pointer;color:inherit;font-size:1.5rem;">
        <i id="dark-mode-icon" class="fas fa-moon"></i>
    </button>
    <form id="search-form" action="{{ url_for('search') }}" method="GET" class="search-bar">
        <input type="text" name="query" placeholder="Search for products..." required>
        <nav class="search-suggestions">
            {% for suggestion in search_suggestions %}
            <a href="{{ url_for('product', product_id=suggestion.id) }}">{{ suggestion.name }}</a>
            {% endfor %}
        </nav>
    </form>
    <nav>
        <button type="submit" form="search-form" class="search-button">
            <i class="fas fa-search"></i>
        </button>
    </nav>
    <nav>
        <a href="{{ url_for('index') }}"><i class="fas fa-home"></i></a>
        <a href="{{ url_for('cart') }}"><i class="fas fa-shopping-cart"></i></a>
        {% if 'user_id' in session %}
        <a href="#" onclick="redirectToDashboard()"><i class="fas fa-user"></i></a>
        <a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i></a>
        {% else %}
        <a href="{{ url_for('login') }}"><i class="fas fa-sign-in-alt"></i></a>
        {% endif %}
    </nav>
</header>

<script>
    function redirectToDashboard() {
        const role = "{{ session.get('role') }}";
        if (role === 'seller') {
            window.location.href = "{{ url_for('seller_dashboard') }}";
        } else if (role === 'consumer') {
            window.location.href = "{{ url_for('consumer_dashboard') }}";
        }
    }
</script>
<script>
    // Dark mode toggle logic
    const toggleBtn = document.getElementById('dark-mode-toggle');
    const icon = document.getElementById('dark-mode-icon');
    function setDarkMode(on) {
        document.body.classList.toggle('dark-mode', on);
        icon.className = on ? 'fas fa-sun' : 'fas fa-moon';
        localStorage.setItem('darkMode', on ? '1' : '0');
    }
    // On load, set mode from localStorage
    document.addEventListener('DOMContentLoaded', function() {
        const dark = localStorage.getItem('darkMode') === '1';
        setDarkMode(dark);
        toggleBtn.addEventListener('click', () => setDarkMode(!document.body.classList.contains('dark-mode')));
    });
</script>
    <main>
        {% block content %}{% endblock %}
    </main>
    <footer>
        <p>&copy; 2025 E-Shop. All rights reserved.</p>
    </footer>
</body>
</html>